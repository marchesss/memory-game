<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Memory ‚Äî Mini Game</title>
  <style>
    :root{
      --bg: #0f1724;
      --card: #e6eef8;
      --accent: #ffd166;
      --muted: #94a3b8;
    }
    html,body{height:100%;}
    body{
      margin:0;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg,#071022 0%, #102238 100%);
      color: #e6eef8;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
      box-sizing:border-box;
    }

    .wrap{
      width:100%;
      max-width:760px;
      background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
      border: 1px solid rgba(255,255,255,0.04);
      padding:20px;
      border-radius:14px;
      box-shadow: 0 8px 30px rgba(3,7,18,0.6);
    }

    header{
      display:flex;
      gap:16px;
      align-items:center;
      margin-bottom:14px;
    }
    h1{font-size:20px;margin:0}
    .controls{margin-left:auto;display:flex;gap:8px;align-items:center}
    button{background:transparent;border:1px solid rgba(230,238,248,0.06);color:var(--accent);padding:6px 10px;border-radius:8px;cursor:pointer}
    .meta{display:flex;gap:12px;align-items:center;color:var(--muted);font-size:13px}

    /* board */
    .board{
      display:grid;
      gap:12px;
      padding:12px;
      justify-items:center;
    }
    /* grid sizes responsive */
    .board.size-4{grid-template-columns:repeat(4, minmax(80px,1fr));}
    .board.size-6{grid-template-columns:repeat(6, minmax(64px,1fr));}
    .board.size-5{grid-template-columns:repeat(5, minmax(70px,1fr));}

    .card{
      width:100%;
      aspect-ratio: 1/1;
      perspective: 900px;
    }
    .inner{
      position:relative;
      width:100%;height:100%;
      transform-style:preserve-3d;
      transition: transform 380ms cubic-bezier(.25,.8,.25,1);
      border-radius:10px;
      box-shadow: 0 6px 18px rgba(2,6,23,0.6);
    }
    .flipped .inner{transform: rotateY(180deg) translateZ(0)}

    .face{
      position:absolute;inset:0;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:28px;backface-visibility:hidden;user-select:none
    }
    .face.front{background:linear-gradient(180deg,#0b1220,#0e1a2d);color:#cde3ff;border:1px solid rgba(255,255,255,0.03)}
    .face.back{background: linear-gradient(180deg,#fff,#f2f7ff);color:#0b1220;transform:rotateY(180deg);font-size:28px}

    /* little pop when match */
    .matched .inner{animation:pop 420ms ease-out}
    @keyframes pop{0%{transform:scale(1) rotateY(180deg)}50%{transform:scale(1.06) rotateY(180deg)}100%{transform:scale(1) rotateY(180deg)}}

    .footer{display:flex;align-items:center;justify-content:space-between;margin-top:14px;color:var(--muted);font-size:13px}

    .hint{font-size:12px;color:var(--muted)}

    /* small-screen tweaks */
    @media (max-width:520px){
      .board.size-4{grid-template-columns:repeat(4, minmax(56px,1fr));}
      .inner{border-radius:8px}
      .face{font-size:20px}
    }

    .overlay{
      position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(0deg, rgba(2,6,23,0.6), rgba(2,6,23,0.6));
      visibility:hidden;opacity:0;transition:opacity .2s, visibility .2s;z-index:999;
    }
    .overlay.show{visibility:visible;opacity:1}
    .modal{background:#071129;padding:22px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);max-width:420px;text-align:center}
    .modal h2{margin:0 0 8px 0}
    .modal p{color:var(--muted);margin:0 0 16px 0}

  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Memory ‚Äî match the pairs</h1>
        <div class="hint">Tap cards to flip ‚Äî match all pairs to win ‚ú®</div>
      </div>
      <div class="controls">
        <div class="meta">Moves: <strong id="moves">0</strong></div>
        <div class="meta">Time: <strong id="time">0s</strong></div>
        <select id="sizeSelect" title="Grid size">
          <option value="4">4√ó4 (easy)</option>
          <option value="5">5√ó4 (medium)</option>
          <option value="6">6√ó4 (hard)</option>
        </select>
        <button id="restart">Restart</button>
      </div>
    </header>

    <main>
      <div id="board" class="board size-4" aria-live="polite"></div>
    </main>

    <div class="footer">
      <div class="meta">Pairs found: <strong id="found">0</strong>/<strong id="total">0</strong></div>
      <div class="meta">Best: <span id="best">‚Äî</span></div>
    </div>
  </div>

  <div class="overlay" id="overlay">
    <div class="modal">
      <h2 id="resultTitle">You did it!</h2>
      <p id="resultText">Time ‚Äî 12s ¬∑ Moves ‚Äî 18</p>
      <div style="display:flex;gap:8px;justify-content:center;margin-top:12px">
        <button id="playAgain">Play again</button>
        <button id="closeModal">Close</button>
      </div>
    </div>
  </div>

  <script>
    // Simple memory game logic ‚Äî single-file, no frameworks.
    (function(){
      const emojis = [
        'üçé','üçä','üçã','üçá','üçì','üçâ','üçå','üçç',
        'ü•ù','ü••','üçí','üçë','üçê','ü•≠','ü•ï','üåΩ','üçÖ','ü•î','üßÄ','üç™','üç©','üç∞','üßÅ','üç´'
      ];

      const boardEl = document.getElementById('board');
      const movesEl = document.getElementById('moves');
      const timeEl = document.getElementById('time');
      const foundEl = document.getElementById('found');
      const totalEl = document.getElementById('total');
      const bestEl = document.getElementById('best');
      const overlay = document.getElementById('overlay');
      const resultText = document.getElementById('resultText');
      const resultTitle = document.getElementById('resultTitle');

      const restartBtn = document.getElementById('restart');
      const sizeSelect = document.getElementById('sizeSelect');
      const playAgain = document.getElementById('playAgain');
      const closeModal = document.getElementById('closeModal');

      let gridCols = 4; // default
      let cols = 4;
      let rows = 4; // implicit by options: we will always show 4 rows; sizeSelect value controls columns number

      let cards = [];
      let firstCard = null;
      let secondCard = null;
      let lock = false;
      let moves = 0;
      let found = 0;
      let totalPairs = 0;

      let timer = null;
      let seconds = 0;

      // best score in localStorage
      function getBestKey(cols){ return memory_best_${cols}x4; }
      function saveBest(cols, time, moves){
        const key = getBestKey(cols);
        const prev = localStorage.getItem(key);
        const value = JSON.stringify({time,moves});
        if(!prev){ localStorage.setItem(key,value); return; }
        try{ const p = JSON.parse(prev);
          // prefer lower moves, then lower time
          if(moves < p.moves || (moves===p.moves && time < p.time)) localStorage.setItem(key,value);
        }catch(e){ localStorage.setItem(key,value); }
      }
      function loadBest(cols){
        const key = getBestKey(cols);
        const prev = localStorage.getItem(key);
        if(!prev) return null;
        try{ return JSON.parse(prev); }catch(e){ return null; }
      }

      function startTimer(){
        if(timer) clearInterval(timer);
        seconds = 0; timeEl.textContent = '0s';
        timer = setInterval(()=>{ seconds++; timeEl.textContent = seconds + 's'; },1000);
      }
      function stopTimer(){ if(timer) clearInterval(timer); timer=null; }

      function shuffle(array){
        for(let i = array.length -1; i>0; i--){
          const j = Math.floor(Math.random()*(i+1));
          [array[i],array[j]]=[array[j],array[i]];
        }
        return array;
      }
      function buildDeck(cols){
        // always 4 rows; columns define difficulty
        const count = cols * 4; // must be even
        const pairCount = Math.floor(count/2);
        totalPairs = pairCount;
        const pool = shuffle(emojis.slice());
        const selected = pool.slice(0,pairCount);
        const deck = shuffle(selected.concat(selected));
        return deck;
      }

      function renderBoard(cols){
        boardEl.className = 'board size-' + cols;
        boardEl.innerHTML = '';

        const deck = buildDeck(cols);
        cards = deck.map((value, i)=>{
          const el = document.createElement('div');
          el.className = 'card';
          el.dataset.index = i;
          el.dataset.value = value;
          el.innerHTML = 
            <div class="inner">
              <div class="face front">?</div>
              <div class="face back">${value}</div>
            </div>;
          boardEl.appendChild(el);
          return el;
        });

        // update counters
        found = 0; moves = 0;
        movesEl.textContent = moves;
        foundEl.textContent = found;
        totalEl.textContent = totalPairs;

        // attach listeners
        cards.forEach(c=>c.addEventListener('click', onCardClick));

        // reset state
        firstCard = null; secondCard = null; lock=false;

        // show for a short preview then hide
        cards.forEach(c=>c.classList.add('flipped'));
        setTimeout(()=>cards.forEach(c=>c.classList.remove('flipped')), 800);

        // timer start when first click
        stopTimer(); timeEl.textContent='0s';

        // show best
        const b = loadBest(cols);
        if(b) bestEl.textContent = ${b.moves} moves ¬∑ ${b.time}s;
        else bestEl.textContent = '‚Äî';
      }

      function onCardClick(e){
        const card = e.currentTarget;
        if(lock) return;
        if(card.classList.contains('matched')) return;
        if(card===firstCard) return; // clicking same card

        // start timer on first action
        if(!timer) startTimer();

        // flip
        card.classList.add('flipped');

        if(!firstCard){ firstCard = card; return; }

        secondCard = card;
        moves++;
        movesEl.textContent = moves;
        lock = true;

        // check match
        const a = firstCard.dataset.value;
        const b = secondCard.dataset.value;
        if(a === b){
          // matched
          setTimeout(()=>{
            firstCard.classList.add('matched');
            secondCard.classList.add('matched');
            firstCard = null; secondCard = null; lock=false;
            found++;
            foundEl.textContent = found;
            // win?
            if(found === totalPairs){
              stopTimer();
              showWin();
            }
          }, 360);
        }else{
          // not match - flip back
          setTimeout(()=>{
            firstCard.classList.remove('flipped');
            secondCard.classList.remove('flipped');
            firstCard = null; secondCard = null; lock=false;
          }, 700);
        }
      }

      function showWin(){
        // save best if better
        saveBest(cols, seconds, moves);
        const b = loadBest(cols);
        if(b) bestEl.textContent = ${b.moves} moves ¬∑ ${b.time}s;

        resultTitle.textContent = 'Level complete üéâ';
        resultText.textContent = Time ‚Äî ${seconds}s ¬∑ Moves ‚Äî ${moves};
        overlay.classList.add('show');
      }

      // wire UI
      restartBtn.addEventListener('click', ()=>{
        renderBoard(cols);
      });
      sizeSelect.addEventListener('change', (e)=>{
        cols = Number(e.target.value);
        renderBoard(cols);
      });
      playAgain.addEventListener('click', ()=>{ overlay.classList.remove('show'); renderBoard(cols); });
      closeModal.addEventListener('click', ()=>{ overlay.classList.remove('show'); });

      // init
      cols = Number(sizeSelect.value);
      renderBoard(cols);

    })();
  </script>
</body>
</html>
